let e={students:{gamemode:"Students",imgSubfolder:"students",question:"Who is this student?",urlAdress:"https://hp-api.onrender.com/api/characters",filterKey:"hogwartsStudent",filterValue:!0,ids:28,answerProperty:"name"},staff:{gamemode:"Staff",imgSubfolder:"staff",question:"Who is this staff?",urlAdress:"https://hp-api.onrender.com/api/characters",filterKey:"hogwartsStaff",filterValue:!0,ids:20,answerProperty:"name"},houses:{gamemode:"Houses",imgSubfolder:"students",question:"From which house is this student?",urlAdress:"https://hp-api.onrender.com/api/characters",filterKey:"hogwartsStudent",filterValue:!0,ids:28,answerProperty:"house"}},t={students_medium:[{name:"unranked",result:"0"},{name:"unranked",result:"0"},{name:"unranked",result:"0"}],students_hard:[{name:"unranked",result:"0"},{name:"unranked",result:"0"},{name:"unranked",result:"0"}],staff_medium:[{name:"unranked",result:"0"},{name:"unranked",result:"0"},{name:"unranked",result:"0"}],staff_hard:[{name:"unranked",result:"0"},{name:"unranked",result:"0"},{name:"unranked",result:"0"}],houses_medium:[{name:"unranked",result:"0"},{name:"unranked",result:"0"},{name:"unranked",result:"0"}],houses_hard:[{name:"unranked",result:"0"},{name:"unranked",result:"0"},{name:"unranked",result:"0"}]},s=["Gryffindor","Slytherin","Hufflepuff","Ravenclaw"],a={easy:{time:null,level:"easy"},medium:{time:.25,level:"medium"},hard:{time:.16667,level:"hard"}};e.students.urlAdress;var r=class{constructor(){}static saveRankings(e){return localStorage.setItem("rankings",JSON.stringify(e)),e}static loadRankings(){return JSON.parse(localStorage.getItem("rankings"))||this.saveRankings(t)}},i=class{constructor(){this.gameMode="",this.difficultyLevel="medium",this.rankings=r.loadRankings(),this.localStorageService=r,this.gameMaker=void 0}},o=function(e,t){t.forEach(t=>{"string"==typeof t?e.appendChild(document.createTextNode(t)):e.appendChild(t)})},n=function(e,t={},...s){let a=document.createElement(e);return Object.entries(t).forEach(([e,t])=>{a.setAttribute(e,t)}),o(a,s),a};let l={};var d=function(e,t){let s=n("img",{class:"game-image__content-image modal-img-node",alt:`${t}`});l.ref=s;if(/^data:image\/(?:gif|png|jpeg|bmp|webp)(?:;charset=utf-8)?;base64,(?:[A-Za-z0-9]|[+/])+={0,2}/.test(e)||/\.(jpg|jpeg|png|gif|bmp|webp)$/i.test(e)||e.startsWith("http"))l.ref.setAttribute("src",e);else throw Error("Ups, format of input string is incorrect");return s};let h=[n("button",{class:"button"},"Students"),n("button",{class:"button"},"Houses"),n("button",{class:"button"},"Staff")];var m={};m=import.meta.resolve("hdvin");var u=function(e){let t=function(){let t=e.detailQuestionData,s=[];for(let e=0;e<t.length;e++){let a=t[e],r=a.playerAnswer,{answer:i}=a,o=n("td",{class:"details__td"},d(a.imageBase64,"very handsome someone")),l=n("td",{class:"details__td"},r),h=n("td",{class:"details__td"},i),m=n("tr",{class:"details__tr"},o,l,h);s.push(m)}return s}(e),s=n("tbody",{},...t),a=["Picture","Your answer","Answer"].map(e=>n("th",{class:"details__th"},e)),r=n("tr",{class:"details__thead"},...a),i=n("thead",{},r);return n("table",{class:"details__table"},i,s)},c=function(e){let t=n("div",{class:"modal__text"},"Game details");return n("div",{class:"details"},t,u(e))},g=function(){let e=n("input",{class:"modal__input",placeholder:"your nickname",type:"text",name:"name",id:"playerName",required:null},"Input"),t=n("label",{class:"modal__label",for:"name"},"Please fill your name to bring glory to your house!"),s=n("button",{class:"game__button game__button-modalBtn"},"Save result and return!"),a=n("div",{class:"modal__builder"},e,s);return n("div",{class:"modal__form"},t,a)},f=function(e){let t=n("h2",{class:"modal__header"},"Game Over"),s=n("p",{class:"modal__text"},function(e){let t=e.correctAnswerScore,s=e.askedQuestions,a="";switch(!0){case t<-10:a=`Your result: ${t} / ${s}. 
"Honestly, if you were any slower, you'd be going backward." \u{2014} Draco Malfoy`;break;case t>=-10&&t<1:a=`Your result: ${t} / ${s}. 
"I hope you're pleased with yourselves. We could all have been killed \u{2014} or worse, expelled. Now if you don't mind, I'm going to bed." \u{2015} Hermione Granger`;break;case t>=1&&t<11:a=`Your result: ${t} / ${s}. 
"When in doubt, go to the library." \u{2014} Ron Weasley " `;break;case t>=11:a=`Your result: ${t} / ${s}. 
"You're a little scary sometimes, you know that? Brilliant ... but scary." \u{2014} Ron Weasley`;break;default:a=`This is magic! You've got ${t}/${s}  questions! Congratulations!`}return a}(e)),a=n("div",{class:"modal__container"},t,s,c(e),g());return n("div",{class:"modal"},a)},w=function(e){return n("button",{class:"game__button game__button--orange"},e)},_={};_=import.meta.resolve("47oLX");var y=function(){return n("img",{src:new URL(_).href,class:"game-image__content-image",alt:"very handsome Harry"})},b=function(e){let t=n("span",{class:"game__button-icon fas fa-trophy"});return n("button",{class:"game__button game__button--hof"},t,e)},p=function(e,t,s,a){let i,o,n,l=r.loadRankings(),d=[l.students_easy,l.students_medium,l.students_hard],h=[l.houses_easy,l.houses_medium,l.houses_hard],m=[l.staff_easy,l.staff_medium,l.staff_hard],u=e.toLowerCase(),c=t.toLowerCase();if("easy"===c)i=0;else if("medium"===c)i=1;else if("hard"===c)i=2;else throw Error("Wrong level data");if("staff"===u)o=m;else if("students"===u)o=d;else if("houses"===u)o=h;else throw Error("Wrong mode data");if("1"===s)n=0;else if("2"===s)n=1;else if("3"===s)n=2;else throw Error("Wrong place data");if(i&&!(o[i].length<n))return o[i][n][a]};function v(e,t,s){return""===p(e,t,s,"name")?"Noname Muggle":p(e,t,s,"name")}var A=function(e,t){if("easy"===t)return n("p",{class:"hof__table-alttxt"},"Easy mode has no ranking available!!!");let s=n("td",{class:"hof__table-header"},"Place"),a=n("td",{class:"hof__table-header"},"Player"),r=n("td",{class:"hof__table-header"},"Points"),i=n("tr",{},n("td",{class:"hof__table-place"},"1"),n("td",{class:"hof__table-player1"},`${v(e,t,"1")}`),n("td",{class:"hof__table-answered1"},`${p(e,t,"1","result")}`)),o=n("tr",{},n("td",{class:"hof__table-place"},"2"),n("td",{class:"hof__table-player2"},`${v(e,t,"2")}`),n("td",{class:"hof__table-answered2"},`${p(e,t,"2","result")}`)),l=n("tr",{},n("td",{class:"hof__table-place"},"3"),n("td",{class:"hof__table-player3"},`${v(e,t,"3")}`),n("td",{class:"hof__table-answered3"},`${p(e,t,"3","result")}`));return n("table",{class:"hof__table"},s,a,r,i,o,l)},M=function(e){let t=Math.floor(e/60),s=e%60,a=n("p",{class:"game-timer__text"});return e<=20&&(a.style.color="#E23336"),e<10||e%60==0?a.innerText=`Time Left: ${t}m 0${s}s`:a.innerText=`Time Left: ${t}m ${s}s`,a};let S=[n("button",{class:"game__button game__button-lvlSettings"},"Easy - unlimited time / no points"),n("button",{class:"game__button game__button-lvlSettings active"},"Medium - 15 seconds / good answer: 1 point / wrong answer: 0 points"),n("button",{class:"game__button game__button-lvlSettings"},"Hard - 10 seconds / good answer: 1 point / wrong answer: -1 point")];var k=function(e){let t=[];return e.answers.forEach((s,a)=>{t.push(n("button",{class:"game__mode-rules-answrBtn"},e.answers[a]))}),t},H=function(e){e.map(e=>e.classList.remove("active"))},F={};F=import.meta.resolve("kcylu");let E=[n("p",{class:"game__mode-rules-text"},"Lets find out if you are true wizard or regular  muggle! Test yourself and check if you know all  of the Hogwartâ€™s secrets."),n("p",{class:"game__mode-rules-text"},"Pick the game mode from main menu and answer all the question we prepared for you.")];var L=function(e){return n("button",{class:"game__button game__button-settingsBtn"},e)},P=class{constructor(){this.toggleRulesHof="hall of fame",this.settings=!1}render(e,...t){if(0===t.length||!e)throw Error("Required query and at least one child in arguments");let s=document.querySelector(e);if(s.innerHTML="",!s)throw Error(`Not found element by query ${e}`);o(s,t)}renderInitialScreen(){this.render(".header__game-logo",n("img",{src:new URL(m).href,class:"header__game-img"})),this.render(".header__game-nav",...h),this.render(".game__mode","Harry Potter Quiz Game"),this.render(".game__mode-rules",...E),this.render(".game-image__content",y())}showViewsForChosenMode=e=>{let t,s;this.render(".game__mode",n("p",{style:"font-weight: 500"},`MODE: ${{students:"Who is this Hogwart's student?",staff:"Who is this from Hogwart's staff?",houses:"To which house do they belong\n?"}[e]}`)),this.render(".game__mode-rules",...(t=n("span",{class:"rules-icon fas fa-graduation-cap"}),s=n("h2",{class:"game__mode-rules-header"},t,"Mode Rules"),[s,n("p",{class:"game__mode-rules-text"},`You have limited time to answer as many questions, as possible. During the game, on each question you need to select ${{students:"the name of Hogwart's student",staff:"the name of Hogwart's staff member",houses:"a Hogwart's house of the character"}[e]} from available options.`)])),this.render(".game__btns",b("Hall of fame"),w("Play the game"));let a=L("settings");a.addEventListener("click",this.toggleSettingsView),this.render(".game-image__btns",a),this.settings=!1};showRulesButtons(){let e;this.render(".game__btns",(e=n("span",{class:"game__button-icon fas fa-graduation-cap"}),n("button",{class:"game__button game__button-rules"},e,"rules")),w("Play the game"))}showHof=(e,t)=>{let s;this.render(".game__mode","HALL OF FAME"),this.render(".game__mode-rules",...(s=n("span",{class:"rules-icon fas fa-trophy"}),[n("h2",{class:"game__mode-rules-header"},s,` ${e} Mode Ranking - Level ${t}`),A(e,t)])),this.showRulesButtons()};showSettings(){this.render(".game__mode","Choose level"),this.render(".game__mode-rules",...S);let e=L("Save&back");e.addEventListener("click",this.toggleSettingsView),this.render(".game-image__btns",e),this.bindDifficultyLevelButton(window.app.changeDifficultyLevel)}hideSettings(){this.showViewsForChosenMode(window.app.model.gameMode),window.app.bindInitialHofAndPlay(),this.toggleRulesHof="hall of fame"}toggleSettingsView=()=>{this.settings?(this.hideSettings(),this.settings=!1):(this.showSettings(),this.settings=!0)};renderTimer(e,t,s=!1){if(s){let t,s,a,r,i,o;this.render(".game-timer",...(t=n("div",{class:"game-timer__text-wrapper"}),s=M(e),t.appendChild(s),a=n("img",{class:"game-timer__image",src:new URL(F).href,alt:"The shaft of the wand"}),r=n("div",{class:"game-timer__wand-inner"}),i=n("div",{class:"game-timer__wand"},r),o=[n("div",{class:"game-timer__wand-wrapper"},a,i),t],0===e?(r.style.width="0%",r.style.animation="none"):(r.style.animationDuration=`${e}s`,r.style.animationPlayState="running"),o))}else this.render(".game-timer__text-wrapper",M(e))}renderModal(e){this.render(".modal",f(e)),document.querySelector(".modal").classList.remove("modal__hidden")}renderImage(){this.render(".game-image__content",d())}changeAnswrBtnBgColor(e){let t=document.querySelectorAll(".game__mode-rules-answrBtn");!0===e?t.forEach(e=>e.classList.add("game__mode-rules-answrBtn-correct")):t.forEach(e=>e.classList.add("game__mode-rules-answrBtn-false"))}renderQuitGame(){let e,t;this.render(".header__game-nav",(e=n("i",{class:"far fa-times-circle"}),t=n("p",{class:".quit-game-text"},"Quit Game"),n("div",{class:"quit-game"},t,e)))}renderLoadingScreen(){this.render(".game__mode","Get Ready!"),this.render(".game__mode-rules",n("h2",{class:"loading-screen__text"},"Get ready!"),n("p",{class:"loading-screen__subtext"},"Loading your question...")),this.render(".game-image__content",y())}renderQuestion(e,t){this.render(".game__mode",t),this.render(".game__mode-rules",...k(e)),this.render(".game-image__content",d(e.image,"very handsome Harry"))}disappearButtonsAndBackground(){document.querySelector(".game__btns").style.display="none",document.querySelector(".game-image__btns").style.display="none",document.querySelector(".game__mode-rules").id="question-mode"}appearBackgroundAndButtons(){this.removeClassFromHtmlElement(".game__btns","hidden-elements"),this.removeClassFromHtmlElement(".game-image__btns","hidden-elements"),this.removeAttributeFromHtmlElement(".game__mode-rules","id")}changeCursorToCustom(){document.querySelector(".game").classList.add("custom-cursor"),document.querySelector(".header").classList.add("custom-cursor")}changeGridSizes(){document.querySelector(".game-wrapper").style.gridTemplateRows="1fr 2fr 1fr"}changeNavStyles(){document.querySelector(".header__game-nav").style.justifyContent="flex-end"}renderAfterQuitGame(e){if(e!==a.easy.level){let e=document.querySelector(".game-timer__wand-wrapper");e.remove(e);let t=document.querySelector(".game-timer__text");t.remove(t)}this.render(".header__game-nav",...h),this.removeClassFromHtmlElement(".game","custom-cursor"),this.removeClassFromHtmlElement(".header","custom-cursor"),this.removeAttributeFromHtmlElement(".header__game-nav","style"),this.removeAttributeFromHtmlElement(".game-wrapper","style"),this.removeAttributeFromHtmlElement(".game__btns","style"),this.removeAttributeFromHtmlElement(".game-image__btns","style"),this.render(".game-image__content",y())}removeAttributeFromHtmlElement(e="",t=""){document.querySelector(e).removeAttribute(t)}removeClassFromHtmlElement(e="",t=""){document.querySelector(e).classList.remove(t)}bindButtonPlay(e){document.querySelector(".game__button--orange").addEventListener("click",()=>{e()})}bindModeButtons(e){h.map(t=>t.addEventListener("click",()=>{H(h),t.classList.add("active"),e(t.textContent.toLowerCase())}))}bindAnswerButtons(e){[...document.getElementsByClassName("game__mode-rules-answrBtn")].map(t=>t.addEventListener("click",()=>{e(t.textContent)}))}bindQuitGameButton(e){document.querySelector(".quit-game").addEventListener("click",()=>{e()})}bindHofButton(e){document.querySelector(".game__button--hof").addEventListener("click",()=>{e()})}bindRulesButton(e){document.querySelector(".game__button-rules").addEventListener("click",()=>{e()})}bindDifficultyLevelButton(e){S.map((t,s)=>t.addEventListener("click",()=>{H(S),t.classList.add("active"),e(s)}))}bindModalButton(e){let t=document.querySelector(".game__button-modalBtn"),s=document.querySelector(".modal");t.addEventListener("click",()=>{e(document.getElementById("playerName").value),s.classList.add("modal__hidden"),this.renderInitialScreen()})}};class B{static generateRandomId(e){return Math.floor(Math.random()*(e-0+1)+0)}static generateQuestionsForCurrentMode(e){let t=[];if(e<4||"number"!=typeof e)throw Error`Check amout of ID's and datatype. amountOfId must be greater or equal ${4}. Passed value: ${e}, Type must be number. Passed type: ${typeof e}`;for(let s=0;s<4;s+=1){let s;do s=B.generateRandomId(e);while(!0===t.includes(s))t.push(s)}return t}static chooseCorrectAnswer(e=[]){if(e.forEach(e=>{if("number"!=typeof e)throw Error`wrong datatype in array`}),4===e.length)return e[Math.floor(4*Math.random()+0)];throw Error`4 elements needed. That array has ${e.length} elements`}}var $=class{constructor(e,t,s,a,r=[],i=null,o=null){this.idOfRightAnswer=t,this.resourceAPIadress=e,this.answerProperty=s,this.imgSubfolder=a,this.IDsArray=r,this.filterKey=i,this.filterValue=o,this.arraywithHPObjects=[],this.rightAnswer="",this.base64dataImg="",this.arraywithAnswersForQuestion=[]}getDataForMode(){return this.arraywithHPObjects}getDataForIDs(e){let t=[];return"house"===this.answerProperty?t=s:this.IDsArray.forEach(s=>{let{name:a}=e[s];t.push(a)}),t}async blobToBase64(e){return new Promise(t=>{let s=new FileReader;s.onloadend=()=>t(s.result),s.readAsDataURL(e)})}async getDataForCorrectAnswer(){let e=this.arraywithHPObjects[this.idOfRightAnswer];if("house"===this.answerProperty?this.rightAnswer=e.house:this.rightAnswer=e.name,e.image&&""!==e.image)try{let t=await fetch(e.image),s=await t.blob();this.base64dataImg=await this.blobToBase64(s)}catch(s){console.warn("Failed to fetch image from API, using fallback:",s);let e=await fetch(`./img/images/${this.imgSubfolder}/${this.idOfRightAnswer}.jpg`),t=await e.blob();this.base64dataImg=await this.blobToBase64(t)}else{let e=await fetch(`./img/images/${this.imgSubfolder}/${this.idOfRightAnswer}.jpg`),t=await e.blob();this.base64dataImg=await this.blobToBase64(t)}}async getDataByAPI(){try{if(!this.arraywithHPObjects||0===this.arraywithHPObjects.length){let e;try{let t=await fetch(this.resourceAPIadress);if(!t.ok)throw Error(`API responded with status ${t.status}`);e=await t.json()}catch(s){console.warn("Failed to fetch from API, using mock data:",s);let t=await fetch("./src/app/data/characters-mock.json");e=await t.json()}this.filterKey&&null!==this.filterValue?(this.arraywithHPObjects=e.filter(e=>e[this.filterKey]===this.filterValue&&e.image&&""!==e.image),console.log(`Filtered ${this.arraywithHPObjects.length} characters with ${this.filterKey}=${this.filterValue}`)):(this.arraywithHPObjects=e.filter(e=>e.image&&""!==e.image),console.log(`Filtered ${this.arraywithHPObjects.length} characters with images`))}}catch(e){throw Error(`${e}`)}}},R=class{constructor(t){this.urlAdress=e[t].urlAdress,this.amountOfIDs=e[t].ids,this.answerProperty=e[t].answerProperty,this.imgSubfolder=e[t].imgSubfolder,this.filterKey=e[t].filterKey,this.filterValue=e[t].filterValue,this.arrayWithObjectsForMode=[],this.usedQuestionIndices=[]}async getQuestion(){let e=new $(this.urlAdress,0,this.answerProperty,this.imgSubfolder,[],this.filterKey,this.filterValue);if(0===this.arrayWithObjectsForMode.length?(await e.getDataByAPI(),this.arrayWithObjectsForMode=e.getDataForMode(),console.log(`Loaded ${this.arrayWithObjectsForMode.length} characters for mode`)):e.arraywithHPObjects=this.arrayWithObjectsForMode,this.usedQuestionIndices.length>=this.arrayWithObjectsForMode.length)return console.log("All questions used! Game over."),null;let t=[];for(let e=0;e<this.arrayWithObjectsForMode.length;e++)this.usedQuestionIndices.includes(e)||t.push(e);console.log(`Available questions: ${t.length}, Total: ${this.arrayWithObjectsForMode.length}`);let s=Math.floor(Math.random()*t.length),a=t[s];this.usedQuestionIndices.push(a),console.log(`Used ${this.usedQuestionIndices.length}/${this.arrayWithObjectsForMode.length} questions`);let r=this.arrayWithObjectsForMode[a].gender,i=[];for(let e=0;e<this.arrayWithObjectsForMode.length;e++)this.arrayWithObjectsForMode[e].gender===r&&i.push(e);console.log(`Correct answer gender: ${r}, available same gender: ${i.length}`);let o=[a];if(i.length>=4){let e=[];for(;e.length<3;){let t=Math.floor(Math.random()*i.length),s=i[t];s===a||e.includes(s)||e.push(s)}o.push(...e)}else{console.warn(`Not enough same-gender characters (${i.length}), using all characters`);let e=this.arrayWithObjectsForMode.length-1;if(!(o=B.generateQuestionsForCurrentMode(e)).includes(a)){let e=Math.floor(Math.random()*o.length);o[e]=a}}for(let e=o.length-1;e>0;e--){let t=Math.floor(Math.random()*(e+1));[o[e],o[t]]=[o[t],o[e]]}e.idOfRightAnswer=a,e.IDsArray=o,e.arraywithAnswersForQuestion=e.getDataForIDs(e.arraywithHPObjects),await e.getDataForCorrectAnswer();let{arraywithAnswersForQuestion:n,rightAnswer:l,base64dataImg:d}=e;return{image:d,answers:n,rightAnswer:l}}getObjectsForMode(){if(this.arrayWithObjectsForMode.length>0)return this.arrayWithObjectsForMode;throw Error("arrayWithObjectsForMode is empty, lets start the game for the first time")}};class O{constructor(){this.correctAnswersScore=0,this.detailQuestionData=[]}checkAndRegisterAnswer(e,t,s,r){if(!t)throw Error("error with given argument: playerAnswer, the value is incorrect, it should be string");let i=t===s;return r!==a.easy.level&&(this.correctAnswersScore=function(e,t,s){let r,i=s===a.medium.level,o=s===a.hard.level;if(!i&&!o)throw Error("wrong difficulty level property or calculatingPoints value");return i&&(r=t?e+1:e),o&&(r=t?e+1:e-1),r}(this.correctAnswersScore,i,r),this.registerAnswer(e,s,t,i)),i}registerAnswer(e,t,s,a){this.detailQuestionData.push({imageBase64:e,playerAnswer:s,isAnswerCorrect:a,answer:t})}clearGameData(){this.correctAnswersScore=0,this.detailQuestionData.length=0}getPlayerEndGameData(){return{correctAnswersScore:this.correctAnswersScore,detailQuestionData:this.detailQuestionData}}}var I=class{constructor(e){this.gameTime=e,this.stopGame=!1,this.timer=null}setGameTime(e){this.gameTime=e}runTimer(e,t){this.timer&&(console.log("Clearing existing timer"),clearInterval(this.timer),this.timer=null),this.stopGame=!1;let s=60*this.gameTime*1e3,a=60*this.gameTime,r=s;e(r/1e3,a),this.timer=setInterval(()=>{!0===this.stopGame?(clearInterval(this.timer),this.timer=null,r=s):r<=0?(clearInterval(this.timer),this.timer=null,r=s,t()):e((r-=1e3)/1e3,a)},1e3)}},j=class{constructor(e,t){this.mainQuestionManager=new R(e),this.difficultyLevelsProperty=t,this.timer=new I(.5),this.player=new O,this.initialGameTimeMinutes=2,this.objectsForMode=[],this.questionObject={}}async createQuestion(){return this.questionObject=await this.mainQuestionManager.getQuestion(),0===this.objectsForMode.length&&(this.objectsForMode=this.mainQuestionManager.arrayWithObjectsForMode),this.questionObject}createPlayerAndRunTimer(e,t){this.player=new O,this.timer&&(console.log("Stopping existing timer before creating new one"),this.timer.stopGame=!0),null!==a[this.difficultyLevelsProperty].time&&(this.timer=new I(a[this.difficultyLevelsProperty].time),this.timer.runTimer(e,t))}checkAndRegisterAnswer(e){return this.player.checkAndRegisterAnswer(this.questionObject.image,e,this.questionObject.rightAnswer,this.difficultyLevelsProperty)}getEndGameData(){let e=this.player.getPlayerEndGameData();return{correctAnswerScore:e.correctAnswersScore,detailQuestionData:e.detailQuestionData,askedQuestions:e.detailQuestionData.length}}clearCurrentGameData(){this.player.clearGameData(),this.timer.stopGame=!0}};let q=new class{constructor(e,t){this.model=e,this.view=t,this.endGameData={},this.view.renderInitialScreen(),this.bindModeButtons()}doAtInterval=(e,t)=>{this.view.renderTimer(e,t,!1)};doAtEnd=()=>{this.endGameData=this.model.gameMaker.getEndGameData(),this.view.renderModal(this.endGameData),this.view.bindModalButton(this.saveName),this.view.appearBackgroundAndButtons(),this.view.renderAfterQuitGame()};saveName=e=>{this.model.name=e,this.saveResult()};startGame=async()=>{console.log("Starting game with mode:",this.model.gameMode,"difficulty:",this.model.difficultyLevel);try{this.model.gameMaker&&(console.log("Clearing previous game"),this.model.gameMaker.clearCurrentGameData()),this.model.gameMaker=new j(this.model.gameMode,this.model.difficultyLevel),this.view.disappearButtonsAndBackground(),this.view.renderQuitGame(),this.view.bindQuitGameButton(this.doAfterQuitGame),this.view.changeCursorToCustom(),this.view.changeGridSizes(),this.view.changeNavStyles(),this.view.renderLoadingScreen(),await new Promise(e=>setTimeout(e,1e3));let e=a[this.model.difficultyLevel].time;if(null!==e){let t=60*e;this.view.renderTimer(t,t,!0)}this.model.gameMaker.createPlayerAndRunTimer(this.doAtInterval,this.doAtEnd),await this.showQuestion()}catch(e){console.error("Error starting game:",e),alert(`Failed to start game: ${e.message}`)}};doAfterQuitGame=()=>{this.model.gameMaker.clearCurrentGameData(),this.changeGameMode(e[this.model.gameMode].gamemode.toLowerCase()),this.view.appearBackgroundAndButtons(),this.view.renderAfterQuitGame(this.model.difficultyLevel)};async showQuestion(){console.log("Showing question for mode:",this.model.gameMode);let{question:t}=e[this.model.gameMode.toLowerCase()],s=await this.model.gameMaker.createQuestion();if(console.log("Question data:",s),null===s){console.log("No more questions available, ending game"),this.doAtEnd();return}this.view.renderQuestion(s,t);let a=this;this.view.bindAnswerButtons(async e=>{let t=a.model.gameMaker.checkAndRegisterAnswer(e);this.view.changeAnswrBtnBgColor(t),await a.showQuestion()})}changeGameMode=e=>{let t=this.model.difficultyLevel;this.model.gameMode=e.toLowerCase(),"hall of fame"===this.view.toggleRulesHof?(this.view.showViewsForChosenMode(e,t),this.bindInitialHofAndPlay()):this.showHofView()};toggleRulesHof=()=>{"hall of fame"===this.view.toggleRulesHof?(this.showHofView(),this.view.toggleRulesHof="rules"):"rules"===this.view.toggleRulesHof&&(this.showRulesForChosenMode(),this.view.toggleRulesHof="hall of fame")};bindInitialHofAndPlay=()=>{this.view.bindHofButton(this.toggleRulesHof),this.view.bindButtonPlay(this.startGame)};bindInitialRulesAndPlay=()=>{this.view.bindRulesButton(this.toggleRulesHof),this.view.bindButtonPlay(this.startGame)};changeDifficultyLevel=e=>{let t=Object.keys(a)[e];this.model.difficultyLevel=a[t].level};showSettingsScreen(){this.view.showSettings()}updateViewsForHallOfFameAtChosenMode(e){this.view.updateViewsForHallOfFameAtChosenMode(e)}saveResult(){let{rankings:e,name:t,gameMode:s,difficultyLevel:a}=this.model,r=this.endGameData.correctAnswerScore,i=`${s}_${a}`;e[i].push({name:t,result:r}),e[i].sort((e,t)=>e.result<t.result?1:-1),e[i].length>3&&e[i].pop(),this.model.localStorageService.saveRankings(e)}showHofView=()=>{this.view.showHof(this.model.gameMode,this.model.difficultyLevel),this.bindInitialRulesAndPlay()};showRulesForChosenMode=()=>{this.view.showViewsForChosenMode(this.model.gameMode),this.view.bindModeButtons(this.changeGameMode),this.bindInitialHofAndPlay()};bindModeButtons=()=>{this.view.bindModeButtons(this.changeGameMode)}}(new i,new P);window.onload=()=>q,window.app=q;
//# sourceMappingURL=Project-I.1f1b4ad4.js.map
